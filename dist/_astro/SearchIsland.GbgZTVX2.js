import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{R as S,r}from"./index.BhTQDHyb.js";import"./_commonjsHelpers.CqkleIqs.js";const U="modulepreload",D=function(s){return"/inwriting/"+s},L={},_=function(h,i,j){let d=Promise.resolve();if(i&&i.length>0){let c=function(o){return Promise.all(o.map(u=>Promise.resolve(u).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),w=a?.nonce||a?.getAttribute("nonce");d=c(i.map(o=>{if(o=D(o),o in L)return;L[o]=!0;const u=o.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${m}`))return;const l=document.createElement("link");if(l.rel=u?"stylesheet":U,u||(l.as="script"),l.crossOrigin="",l.href=o,w&&l.setAttribute("nonce",w),document.head.appendChild(l),u)return new Promise((k,f)=>{l.addEventListener("load",k),l.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})}))}function x(c){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=c,window.dispatchEvent(a),!a.defaultPrevented)throw c}return d.then(c=>{for(const a of c||[])a.status==="rejected"&&x(a.reason);return h().catch(x)})},R=S.memo(({post:s,formatDate:h})=>e.jsx("article",{className:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow flex flex-col h-full",children:e.jsxs("div",{className:"p-5 flex flex-col flex-grow",children:[e.jsx("div",{className:"mb-3",children:e.jsx("h2",{className:"text-lg font-bold text-slate-900 dark:text-white hover:text-indigo-600 dark:hover:text-indigo-400 transition-colors line-clamp-2",children:e.jsx("a",{href:`/blog/${s.slug}`,children:s.title})})}),e.jsx("div",{className:"mb-4 flex-grow",children:e.jsx("p",{className:"text-slate-600 dark:text-slate-300 text-sm line-clamp-3",children:s.description})}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.tags&&s.tags.slice(0,3).map(i=>e.jsx("a",{href:`/tags/${i.toLowerCase().replace(/\s+/g,"-")}`,className:"text-xs px-2 py-0.5 bg-slate-100 dark:bg-slate-700 rounded-full hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors",children:i},i)),s.tags&&s.tags.length>3&&e.jsxs("span",{className:"text-xs px-2 py-0.5 bg-slate-50 dark:bg-slate-800 text-slate-500 dark:text-slate-400 rounded-full",children:["+",s.tags.length-3]})]})}),e.jsx("div",{className:"mt-auto pt-2 border-t border-slate-100 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400 truncate max-w-[50%]",children:["By ",s.author||"Anonymous"]}),e.jsx("time",{dateTime:s.pubDate,className:"text-xs text-slate-500 dark:text-slate-400",children:h(s.pubDate)})]})})]})})),$=S.memo(({tag:s,onClick:h})=>e.jsx("button",{onClick:()=>h(s),className:"text-xs px-3 py-1 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-full transition-colors",children:s})),q=({dataTimestamp:s,popularTags:h=["JavaScript","CSS","React","Web Development","TypeScript"],initialQuery:i=""})=>{const j=r.useCallback(()=>typeof window>"u"?i:new URLSearchParams(window.location.search).get("q")||i,[i]),[d,x]=r.useState(j()),[c,a]=r.useState([]),[w,o]=r.useState([]),[u,m]=r.useState(!1),[l,k]=r.useState(!1),f=r.useRef(null),y=r.useRef(!1),v=r.useCallback(t=>new Date(t).toLocaleDateString("en-us",{year:"numeric",month:"short",day:"numeric"}),[]),b=r.useCallback((t,g=!0)=>{if(!t||!f.current){a([]);return}const n=f.current.search(t);if(a(n),g){const p=new URL(window.location.href);p.searchParams.set("q",t),history.pushState({},"",p)}},[]),N=r.useCallback(()=>{x(""),a([]);const t=new URL(window.location.href);t.searchParams.delete("q"),history.pushState({},"",t)},[]),C=r.useCallback(t=>{const g=t.target.value;x(g);const n=g.trim();n.length>=2?b(n):n.length===0&&N()},[b,N]),E=r.useCallback(t=>{x(t),b(t)},[b]);r.useEffect(()=>{const t=()=>{const n=new URLSearchParams(window.location.search).get("q")||"";if(x(n),f.current&&n){const p=f.current.search(n);a(p)}else a([])};return window.addEventListener("popstate",t),()=>{window.removeEventListener("popstate",t)}},[]),r.useEffect(()=>{let t=!0;return(async()=>{if(!l){m(!0);try{const n=await fetch(`/data/search-data.json?v=${s}`);if(!n.ok)throw new Error("Failed to fetch search data");const p=await n.json();if(!t)return;o(p);const M=(await _(()=>import("./fuse.CvLDeDq6.js"),[])).default;if(f.current=new M(p,{keys:[{name:"title",weight:2},{name:"description",weight:1.5},{name:"tags",weight:1},{name:"categories",weight:1},{name:"author",weight:.5}],includeScore:!0,threshold:.4,ignoreLocation:!0}),!t)return;k(!0)}catch(n){console.error("Error initializing search:",n)}finally{t&&m(!1)}}})(),()=>{t=!1}},[s]),r.useEffect(()=>{if(l&&!y.current){const t=j();t&&b(t,!1),y.current=!0}},[l,j,b]);const P=r.useMemo(()=>e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:h.map(t=>e.jsx($,{tag:t,onClick:E},t))}),[h,E]),A=r.useMemo(()=>!d||c.length===0?null:e.jsx("div",{className:"grid gap-6 md:grid-cols-2",children:c.map(t=>e.jsx(R,{post:t.item,formatDate:v},t.item.slug))}),[d,c,v]),I=r.useMemo(()=>d||u||w.length===0?null:e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"All Articles"}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2",children:w.map(t=>e.jsx(R,{post:t,formatDate:v},t.slug))})]}),[d,u,w,v]);return e.jsxs("div",{className:"mx-auto max-w-3xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",id:"search-input",placeholder:"Search articles, tags or categories...",className:"w-full p-4 pr-12 border border-slate-300 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-500",value:d,onChange:C}),e.jsx("div",{className:"absolute right-4 top-4 text-slate-400",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),P]}),d&&e.jsx("div",{className:"mb-6 text-center py-3 px-4 bg-slate-100 dark:bg-slate-800 rounded-lg",children:e.jsxs("p",{className:"text-slate-600 dark:text-slate-300",children:[e.jsx("span",{children:c.length}),' results matching "',e.jsx("span",{children:d}),'"']})}),u&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:"Loading..."})}),A,d&&c.length===0&&!u&&l&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-300",children:"No matching articles found."}),e.jsxs("p",{className:"mt-2 text-slate-500 dark:text-slate-400",children:["Try different keywords or",e.jsx("button",{onClick:N,className:"text-indigo-600 dark:text-indigo-400 hover:underline ml-1",children:"view all articles"})]})]}),I]})},Q=S.memo(q);export{Q as default};
